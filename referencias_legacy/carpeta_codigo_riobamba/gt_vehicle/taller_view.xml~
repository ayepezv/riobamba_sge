<?xml version="1.0"?>
<openerp>
    <data>

    <record id="view_repair_order_form" model="ir.ui.view">
      <field name="name">view.repair.order.form</field>
      <field name="model">repair.order</field>
      <field name="type">form</field>
      <field name="arch" type="xml">
        <form string="Ordenes Reparación">
        <group string="Estado" col="2" colspan="2">
		  <field name="state" readonly="1" widget="statusbar" statusbar_colors='{"solicitada":"black","proceso":"blue","terminada":"green"}'/>
		  </group>
          <group colspan="4" col="4">
            <group colspan="2" col="2" string="Vehículo">
			  <field name="ref"/>
			  <field name="name"/>
			  <field name="date_start" on_change="validar_tiempo(date_start)"/>
			  <field name="project_id"/>
			</group>
            <group colspan="2" col="2" string="Descripción">
			  <field name="description" nolabel="1"/>
			</group>
		  </group>
		  <notebook colspan="4">
			<page string="Detalle Repuestos">
			  <field name="product_ids" nolabel="1" colspan="4">
				<tree editable="bottom" string="Detalle Repuestos">
				  <field name="name"/>
				  <field name="qty"/>
				  <field name="in_order"/>
				</tree>
			  </field>
			</page>
          </notebook>
		  <newline/>
		  <group colspan="3" col="2">
		  </group>
		  <group colspan="1" col="2"> 
			<button name="repair_proceso" type="object" states="solicitada" string="Proceso" icon="gtk-go-forward" confirm="Cuando usted procesa una órden de reparación se genera un egreso de bodega, ¿Está seguro que desea continuar?"/>
			<button name="repair_terminado" type="object" states="proceso" string="Terminado" icon="gtk-ok"/>
		  </group>
		  <group colspan="3" col="2">
		  </group>			
		  <group colspan="1" col="2" string="Solicitar Compra" states="solicitada">
			<button name="repair_create_sc" type="object" states="solicitada" string="Solicitar Compra" icon="gtk-execute" confirm="Esta seguro que desea crear una solicitud de compra, esta se creará con los productos que tienen activa la opción de solicitar compra"/>
		  </group>
        </form>
      </field>
    </record>
	
    <record id="view_repair_order_tree" model="ir.ui.view">
      <field name="name">view.repair.order.tree</field>
      <field name="model">repair.order</field>
      <field name="type">tree</field>
      <field name="arch" type="xml">
        <tree string="Órdenes Reparación" colors="black:state=='solicitada';blue:state=='proceso';green:state=='terminada'">
          <field name="name"/>
		  <field name="ref"/>		  
		  <field name="date_start"/>		 
		  <field name="state"/>
        </tree>
      </field>
    </record>

    <record id="view_repair_order_search" model="ir.ui.view">
      <field name="name">view.repair.order.search</field>
      <field name="model">repair.order</field>
      <field name="type">search</field>
      <field name="arch" type="xml">
        <search string="Buscar Órdenes Reparación">
          <group>
            <separator orientation="vertical"/>
            <field name="name"/>
			<field name="ref"/>			
			<field name="date_start"/>
			<field name="state"/>			
          </group>
          <newline/>
          <group string="Agrupar por...">
            <filter string="Vehículo" icon="terp-tools" domain="[]" context="{'group_by':'name'}"/>
            <filter string="Fecha" icon="terp-calendar" domain="[]" context="{'group_by':'date_start'}"/>
			<filter string="Proyecto" icon="terp-partner" domain="[]" context="{'group_by':'project_id'}"/>
			<filter string="Estado" icon="gtk-edit" domain="[]" context="{'group_by':'state'}"/>		
          </group>
        </search>
      </field>
    </record>

    <record id="action_repair_order" model="ir.actions.act_window">
      <field name="name">Ordenes Reparación</field>
      <field name="res_model">repair.order</field>
      <field name="view_type">form</field>
      <field name="view_mode">tree,form</field>
      <field name="search_view_id" ref="view_repair_order_search"/>
    </record>

    <menuitem id="menu_repair_order" parent="menu_vehicle_root" name="Talleres" sequence="5"/>

    <menuitem id="menu_repair_order_action" parent="menu_repair_order"
              action="action_repair_order" sequence="1"/>

    </data>
</openerp>
