<?xml version="1.0"?>
<openerp>
    <data> <!-- vista principal es la superior la del modulo mecanica
		-->

    <menuitem id="menu_mecanica" name="Mecanica" />


<!-- vista de asistente para cargar los requerimientos -->
        <record id="view_import_rqm_mantenimiento_wizard" model="ir.ui.view">
            <field name="name">Importar Requerimiento</field>
            <field name="model">import.rqm.mantenimiento</field>
            <field name="type">form</field>
            <field name="arch" type="xml">
              <form string="Importar Requerimiento">
                <label string="Este asistente realiza la importacion del requerimiento solicitado" colspan="4"/>
                <field name="rqm_id_mant" domain="[('objeto_id_id','=',activo_vehiculo_id),('flag','=',False)]" colspan="4" /> <!-- coompara el objeto_id_id que es el campo de vehiculo maquinaria que esta en la tabla stock_requisition compara con el campo activo_vehiculo que esta la tabla vehiculo -->
                
                <newline/>
                <separator colspan="4"/>
                <group col="2" colspan="4">
                  <button icon='gtk-cancel' special="cancel"
                          string="Cancelar" />
                  <button name="import_rqm_mantenimiento_vehiculo" string="Importar"
                          colspan="1" type="object" icon="gtk-ok" />
                </group>
                </form>
            </field>
        </record>

        <act_window name="Importar Requerimiento "
            res_model="import.rqm.mantenimiento"
            src_model="vehiculo"
            view_mode="form"
            target="new"
            key2="client_action_multi"
            id="act_import_rqm_mecanica"/>


<!-- formulario de maquinaria -->
      <record model="ir.ui.view" id="view_maquinaria_form">
		<field name="name">maquinaria.form</field>
		<field name="model">vehiculo</field>
		<field name="type">form</field>
                <field name="priority">30</field>
		<field name="arch" type="xml">
		  <form string="Maquinaria">
			<group col="4" colspan="4">
			  <field name="name"  colspan="2" /> <!--cuando readonly="1"  que se activa para solo lectura-->
                          <field name="create_user_id" colspan="2" readonly="1" string="Creado por:"/>
                          <field name="activo_vehiculo_id" string= "Maquinaria" colspan="4" required="1" domain="[('category_id','=',4),('subcateg_id','in',[284,285,286,287,288])]" widget="selection" />
			  <newline/>
		        </group>
			  <newline/>

      <notebook colspan="4">
      <!-- pagina de lubricacion del maquinaria-->
	<page string="Lubricacion">
	  <field colspan="4" name="lubricante_ids" nolabel="1" widget="one2many_list">
	    <tree string="Lubricacion de Maquinaria" editable="bottom">
              <field name="fecha" required="1"/>
              <field name="tipo_lubricante_id" invisible="1"/>
              <field name="descripcion_lubricante" required="1"/>
              <field name="cantidad" required="1"/>
              <field name="unidad_id" required="1"/>
	      <field name="name" required="1"/>
              <field name="proximo_cambio_kilometraje" required="1"/>
              <field name="requerimiento_quitar_lubri" required="1"/>
              <field name="tipo_cambio_id" required="1"/>

	    </tree>
	  </field>

	</page>
        <!-- pagina de mantenimiento de vehiculo               ESTO SE LE KITA PARA PONER UN ASISTENTE APARTE-->
        <page string="Repuestos, Reparación y Mantenimiento">

	  <field colspan="4" name="mantenimiento_ids" nolabel="1" widget="one2many_list">
	    <tree string="Mantenimiento de Maquinaria" editable="bottom">
		<field name="date"/>		
                <field name="name" select="1"/>
                <field name="cantidad"/>
		<field name="unidad_id"/>
		<field name="kilometraje"/>
                <field name="requerimiento_cajachica"/>
		<field name="observaciones"/> 	

	    </tree>
	  </field>
        </page>     
        <!-- pagina de combustibles de vehiculo -->
	<page string="Combustibles">
	  <field colspan="4" name="combustible_ids" nolabel="1" widget="one2many_list"> 
	    <tree string="Combustibles de Maquinarias" editable="bottom">
              <field name="date" required="1"/>
              <field name="cantidad" required="1"/>
              <field name="name" required="1"/>
              <field name="observaciones" required="1"/>
            </tree> 
	  </field>    

	<!--    <button name="calcular_combustibles" colspan="2" string="Calcular" type="object" />     -->             	  
	</page>

                 <!-- pagina de choferes de vehiculo -->
		
		<page string="Choferes">
		  <field name='chofer_ids' nolabel="1">
		    <tree>
                      <field name='chofer_id' required="1" />
		      <field name='name' required="1"/>
		    </tree>
		    <form>
                      <field name='chofer_id' required="1" on_change="carga_puesto(chofer_id)" />
		      <field name='name'  required="1" />
		    </form>
		  </field>
		</page>
      </notebook>
	      <group colspan="4" col="6">
	          <field name='state' readonly="1" widget="statusbar" statusbar_colors='{"Disponible":"blue","Reparacion":"red"}'/>
	          <button name="disponible_reparacion" colspan="1" string="En reparacion" states='Disponible'
		      type="object" icon="gtk-execute"/>
	          <button name="reparacion_disponible"  string="En disponible" states='Reparacion' 
		      type="object" icon="gtk-execute"/>
              </group>
		  </form>
		</field>
      </record>
	<!-- formulario de vista tree o en lista de la lubricacion
		-->	  
      <record id="view_maquinaria_tree" model="ir.ui.view">
		<field name="name">maquinaria.tree</field>
		<field name="model">vehiculo</field>
		<field name="type">tree</field>
		<field name="arch" type="xml">
		  <tree string="Maquinarias" >
			<field name="name"/>
                        <field name="activo_vehiculo_id" string= "Maquinaria"/>
		  </tree>
		</field>
      </record>
	<!-- formulario de vista para la busqueda del objeto lubricacion
		-->
      <record id="view_maquinaria_filter" model="ir.ui.view">
	<field name="name">Maquinaria Busqueda</field>
	<field name="model">vehiculo</field>
	<field name="type">search</field>
	<field name="arch" type="xml">
	  <search string="Maquinarias">
	    <field name="name"/>
            <field name="activo_vehiculo_id" string="Maquinaria"/>
	    <newline />
	    <newline />
	  </search>
	</field>
      </record>
	<!-- al hacer click se abren el formulario de ingreso del la maquinaria
		-->  
      <record id="action_maquinaria" model="ir.actions.act_window">
		<field name="name">Maquinarias</field>
                <field name="type">ir.actions.act_window</field> 
		<field name="res_model">vehiculo</field>
		<field name="view_type">form</field>
                <field name="help">Maquinarias</field>
	  	    <field name="domain">[('type','=','Maquinaria')]</field>
		    <field name="context">{'default_type': 'Maquinaria'}</field> 
                <field name="view_id" ref="view_maquinaria_tree"/>
      </record>
<!-- estas 2 vistas se incrementan, éstas no se encuentran en en vehiculo_view y no se por que ni que hace-->
    <record id="view_maquinaria_2_tree" model="ir.actions.act_window.view">
        <field eval="1" name="sequence"/>
        <field name="view_mode">tree</field>
        <field name="view_id" ref="view_maquinaria_tree"/>
        <field name="act_window_id" ref="action_maquinaria"/>
    </record>
    <record id="view_maquinaria_2_form" model="ir.actions.act_window.view">
        <field eval="2" name="sequence"/>
        <field name="view_mode">form</field>
        <field name="view_id" ref="view_maquinaria_form"/>
        <field name="act_window_id" ref="action_maquinaria"/>
    </record>	


<!-- el menu en la parte izquierda donde aparece el cliente-->   
      <menuitem id="menu_mecanica_maquinaria" sequence="2" action="action_maquinaria" parent="menu_mecanica" name="Maquinarias" />


    </data>
</openerp>
