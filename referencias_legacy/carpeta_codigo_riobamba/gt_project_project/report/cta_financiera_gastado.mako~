<html>
<head>
    <style type="text/css">
        ${css}
    </style>
</head>
<body>
  %for o in objects:
<% 
     vars = _vars(o)
%> 
  <table WIDTH="100%">
    <tr>
      <td width="100%" style="font-size:14;text-align:center;">CUENTA FINANCIERA ENTRE INGRESOS Y GASTOS COMPROMETIDO DEL ${o.name or  ''}</td>	  	  
    </tr>
    <tr>
      <td width="100%" style="font-size:14;text-align:center;">GESTION FINANCIERA</td>	
    </tr>
    <tr>
      <td width="100%" style="font-size:14;text-align:center;">PRESUPUESTOS</td>	
    </tr>	
  </table>
<table cellspacing="0" cellpadding="1" WIDTH="100%">
  <tr>
    <td style="font-size:11px" WIDTH="15%">Fechas:</td>
    <td style="font-size:11px" align="left" WIDTH="85%">Del: ${vars['date_from']} Al: ${vars['date_to']}</td>    
  </tr>   
</table>
  <p></p>
  <table WIDTH="100%" border="1" cellpadding="2" cellspacing="0"  bordercolor="#000000" style="border-collapse:collapse;font-size:8px">
    <thead style="display: table-header-group">
      <tr>
	<th style="font-size:8px" width="5%"><b>Codigo</b></th>
        <th style="font-size:8px" width="27%"><b>Cuenta Financiera</b></th>
        <th style="font-size:8px" width="8%">Pres. Inicial</th>
        <th style="font-size:8px" width="8%">Reformas</th>
        <th style="font-size:8px" width="8%">Pres. Final</th>
        <th style="font-size:8px" width="8%">Ingresos</th>
        <th style="font-size:8px" width="8%">Gastos</th>
        <th style="font-size:8px" width="8%">Saldos</th>
        <th style="font-size:8px" width="20%">Partida Gasto</th>
      </tr>
    </thead>
    <%res=_get_totales(o)%>
    <%result_dic=res.values()%>
    <%import operator%>
    <%dic_ord=sorted(result_dic, key=operator.itemgetter('code'))%>
    <%
       p_t = p_r = p_c = p_i = p_g = p_s = 0
       %>
    %for values in dic_ord:
    <%
       p_t += values['planned_amount']
       p_r += values['reform']
       p_c += values['codificado']
       p_i += values['ingresos']
       p_g += values['gastos']
       p_s += values['saldo']
       %>
    <tr style="page-break-inside:avoid">
      <td width="5%" style="font-size:8px;text-align:center"><b>${ values['code'] }</b> </td>
      <td width="27%" style="font-size:8px;text-align:left"><b>${ values['name'] }</b> </td>
      <td width="8%" style="font-size:8px;text-align:right">${ '{:,.2f}'.format(values['planned_amount']) }</td>
      <td width="8%" style="font-size:8px;text-align:right">${ '{:,.2f}'.format(values['reform']) }</td>
      <td width="8%" style="font-size:8px;text-align:right">${ '{:,.2f}'.format(values['codificado']) }</td>
      <td width="8%" style="font-size:8px;text-align:right">${ '{:,.2f}'.format(values['ingresos']) }</td>
      <td width="8%" style="font-size:8px;text-align:right">${ '{:,.2f}'.format(values['gastos']) }</td>
      <td width="8%" style="font-size:8px;text-align:right">${ '{:,.2f}'.format(values['saldo']) }</td>
      <td width="20%" style="font-size:8px;text-align:left">${ values['descripcion'] }</td>
    </tr>
    %endfor
    <tr style="page-break-inside:avoid">
      <td width="5%" style="font-size:8px;text-align:center"><b></b> </td>
      <td width="27%" style="font-size:8px;text-align:left"><b>TOTALES</b> </td>
      <td width="8%" style="font-size:8px;text-align:right">${ '{:,.2f}'.format(p_t) }</td>
      <td width="8%" style="font-size:8px;text-align:right">${ '{:,.2f}'.format(p_r) }</td>
      <td width="8%" style="font-size:8px;text-align:right">${ '{:,.2f}'.format(p_c) }</td>
      <td width="8%" style="font-size:8px;text-align:right">${ '{:,.2f}'.format(p_i) }</td>
      <td width="8%" style="font-size:8px;text-align:right">${ '{:,.2f}'.format(p_g) }</td>
      <td width="8%" style="font-size:8px;text-align:right">${ '{:,.2f}'.format(p_s) }</td>
      <td width="20%" style="font-size:8px;text-align:left"></td>
    </tr> 
  </table>
  %endfor
</html>
